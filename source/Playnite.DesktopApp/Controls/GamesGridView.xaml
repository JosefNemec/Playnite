<UserControl x:Class="Playnite.DesktopApp.Controls.GamesGridView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:pcon="clr-namespace:Playnite.Converters;assembly=Playnite"
             xmlns:pbeh="clr-namespace:Playnite.Behaviors;assembly=Playnite"
             xmlns:pc="clr-namespace:Playnite.DesktopApp.Controls"
             xmlns:p="clr-namespace:Playnite;assembly=Playnite"
             xmlns:pmrk="clr-namespace:Playnite.DesktopApp.Markup"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="502.764">
    
    <UserControl.Resources>
        <pcon:ListToStringConverter x:Key="ListToStringConverter" />
        <pcon:LongToTimePlayedConverter x:Key="LongToTimePlayedConverter" />
        <pcon:NullableDateToStringConverter x:Key="NullableDateToStringConverter" />
        <pcon:DateTimeToLastPlayedConverter x:Key="DateTimeToLastPlayedConverter" />
        <pcon:BoolToYesNoConverter x:Key="BoolToYesNoConverter" />
        <pcon:BoolToAutoWidthConverter x:Key="BoolToAutoWidthConverter" />        
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <pcon:InvertableBooleanToVisibilityConverter x:Key="InvertableBooleanToVisibilityConverter" />
        <pcon:NullToDependencyPropertyUnsetConverter x:Key="NullToDependencyPropertyUnsetConverter" />
        <pcon:CompletionStatusToStringConverter x:Key="CompletionStatusToStringConverter" />
        <pcon:ValueConverterGroup x:Key="EnumCompVisibilityConverter">
            <pcon:EnumToBooleanConverter/>
            <pcon:BooleanToHiddenConverter />
        </pcon:ValueConverterGroup>

        <Style x:Key="TextItemStyle" BasedOn="{StaticResource {x:Type TextBlock}}" TargetType="TextBlock">
            <Setter Property="Margin" Value="0,5,0,5" />
        </Style>

        <Style x:Key="SortIndicator" TargetType="ContentControl" x:Shared="False">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="2,0,0,0" />
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Grid>
                            <TextBlock FontFamily="Marlett" Text="5"
                       Visibility="{Binding Path=AppSettings.ViewSettings.SortingOrderDirection, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrderDirection.Ascending}}"/>
                            <TextBlock FontFamily="Marlett" Text="6"
                       Visibility="{Binding Path=AppSettings.ViewSettings.SortingOrderDirection, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrderDirection.Descending}}"/>
                        </Grid>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <p:BindingProxy x:Key="MainProxy" Data="{Binding}" />
    </UserControl.Resources>

    <ListView x:Name="GridGames" SelectionMode="Extended" BorderThickness="0"
              DataContext="{Binding AppSettings.ViewSettings, RelativeSource={RelativeSource AncestorType=UserControl}}"
              ItemsSource="{Binding ItemsSource, RelativeSource={RelativeSource AncestorType=UserControl}}"
              VirtualizingPanel.VirtualizationMode="Recycling" VirtualizingPanel.IsVirtualizingWhenGrouping="True"
              VirtualizingPanel.CacheLengthUnit="Item" VirtualizingPanel.CacheLength="5">
        <ListView.Resources>
            <p:BindingProxy x:Key="SettingsProxy" Data="{Binding}" />
        </ListView.Resources>
        <ListView.InputBindings>
            <KeyBinding Command="{Binding Data.EditSelectedGamesCommand, Source={StaticResource MainProxy}}"
                        Key ="{Binding Data.EditSelectedGamesCommand.Gesture.Key, Source={StaticResource MainProxy}}"
                        Modifiers="{Binding Data.EditSelectedGamesCommand.Gesture.Modifiers, Source={StaticResource MainProxy}}" />
            <KeyBinding Command="{Binding Data.RemoveSelectedGamesCommand, Source={StaticResource MainProxy}}"
                        Key ="{Binding Data.RemoveSelectedGamesCommand.Gesture.Key, Source={StaticResource MainProxy}}"
                        Modifiers="{Binding Data.RemoveSelectedGamesCommand.Gesture.Modifiers, Source={StaticResource MainProxy}}" />
            <KeyBinding Command="{Binding Data.StartSelectedGameCommand, Source={StaticResource MainProxy}}"
                        Key ="{Binding Data.StartSelectedGameCommand.Gesture.Key, Source={StaticResource MainProxy}}"
                        Modifiers="{Binding Data.StartSelectedGameCommand.Gesture.Modifiers, Source={StaticResource MainProxy}}" />
        </ListView.InputBindings>
        <ListView.ContextMenu>
            <pc:GameMenu DataContext="{Binding PlacementTarget.SelectedItems, RelativeSource={RelativeSource Self}}" />
        </ListView.ContextMenu>
        <ListView.ItemContainerStyle>
            <Style TargetType="{x:Type ListViewItem}" BasedOn="{StaticResource {x:Type ListViewItem}}">
                <EventSetter Event="MouseDoubleClick" Handler="Grid_MouseDoubleClick" />
                <Style.Triggers>
                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding IsInstalled}" Value="False" />
                            <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="Foreground" Value="{StaticResource TextBrushDarker}" />
                    </MultiDataTrigger>
                </Style.Triggers>
            </Style>
        </ListView.ItemContainerStyle>
        <ListView.GroupStyle>
            <GroupStyle>
                <GroupStyle.ContainerStyle>
                    <Style TargetType="{x:Type GroupItem}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate>
                                    <Expander IsExpanded="True"
                                              pbeh:ExpanderBehaviors.SaveState="True"
                                              pbeh:ExpanderBehaviors.SaveStateId="{Binding Name, Mode=OneWay}">
                                        <Expander.Header>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center"
                                                           TextAlignment="Center" Margin="0,0,5,0">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
                                                            <Setter Property="Text" Value="{Binding Name, Converter={StaticResource ObjectToStringConverter}}" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Name, Converter={StaticResource ObjectToStringConverter}}" Value="{x:Null}">
                                                                    <Setter Property="Text" Value="{DynamicResource LOCNone}" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Name, Converter={StaticResource ObjectToStringConverter}}" Value="">
                                                                    <Setter Property="Text" Value="{DynamicResource LOCNone}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <TextBlock Text="{Binding Items.Count, Mode=OneWay, StringFormat=({0})}"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" TextAlignment="Center"
                                                           Foreground="{StaticResource TextBrush}"
                                                           Visibility="{Binding Path=AppSettings.ShowGroupCount, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </Expander.Header>
                                        <ItemsPresenter />
                                    </Expander>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </GroupStyle.ContainerStyle>
            </GroupStyle>
        </ListView.GroupStyle>

        <ListView.View>
            <GridView>
                <GridView.ColumnHeaderContainerStyle>
                    <Style TargetType="GridViewColumnHeader" BasedOn="{StaticResource {x:Type GridViewColumnHeader}}">
                        <EventSetter Event="Loaded" Handler="GridViewColumnHeader_Loaded" />
                        <EventSetter Event="Click" Handler="GridViewColumnHeader_Click" />
                    </Style>                        
                </GridView.ColumnHeaderContainerStyle>
                <GridView.ColumnHeaderContextMenu>
                    <ContextMenu Name="HeaderMenu"
                                 DataContext="{Binding Data, Source={StaticResource SettingsProxy}}">
                        <MenuItem Header="{DynamicResource LOCGameIconTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Icon]}" />
                        <MenuItem Header="{DynamicResource LOCGameNameTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Name]}" />
                        <MenuItem Header="{DynamicResource LOCGamePlatformTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Platform]}" />
                        <MenuItem Header="{DynamicResource LOCGameProviderTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Library]}" />
                        <MenuItem Header="{DynamicResource LOCGameDevelopersTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Developers]}" />
                        <MenuItem Header="{DynamicResource LOCGamePublishersTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Publishers]}" />
                        <MenuItem Header="{DynamicResource LOCGameReleaseDateTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[ReleaseDate]}" />
                        <MenuItem Header="{DynamicResource LOCGameGenresTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Genres]}" />
                        <MenuItem Header="{DynamicResource LOCGameCategoriesTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Categories]}" />
                        <MenuItem Header="{DynamicResource LOCGameTagsTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Tags]}" />
                        <MenuItem Header="{DynamicResource LOCGameIsInstalledTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[IsInstalled]}" />
                        <MenuItem Header="{DynamicResource LOCGameInstallDirTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[InstallDirectory]}" />
                        <MenuItem Header="{DynamicResource LOCGameLastActivityTitle}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[LastActivity]}" />
                        <MenuItem Header="{DynamicResource LOCTimePlayed}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Playtime]}" />
                        <MenuItem Header="{DynamicResource LOCPlayCountLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[PlayCount]}" />
                        <MenuItem Header="{DynamicResource LOCCompletionStatus}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[CompletionStatus]}" />
                        <MenuItem Header="{DynamicResource LOCSeriesLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Series]}" />
                        <MenuItem Header="{DynamicResource LOCVersionLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Version]}" />
                        <MenuItem Header="{DynamicResource LOCAgeRatingLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[AgeRating]}" />
                        <MenuItem Header="{DynamicResource LOCRegionLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Region]}" />
                        <MenuItem Header="{DynamicResource LOCSourceLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Source]}" />
                        <MenuItem Header="{DynamicResource LOCAddedLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Added]}" />
                        <MenuItem Header="{DynamicResource LOCModifiedLabel}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[Modified]}" />
                        <MenuItem Header="{DynamicResource LOCUserScore}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[UserScore]}" />
                        <MenuItem Header="{DynamicResource LOCCriticScore}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[CriticScore]}" />
                        <MenuItem Header="{DynamicResource LOCCommunityScore}"
                                    IsCheckable="True" IsChecked="{Binding GridViewHeaders[CommunityScore]}" />
                    </ContextMenu>
                </GridView.ColumnHeaderContextMenu>
                
                <!-- Icon -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Icon], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}, ConverterParameter=Icon}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Content=" "/>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <Image Width="20" Stretch="Uniform"
                                    RenderOptions.BitmapScalingMode="HighQuality">
                                <Image.Source>
                                    <PriorityBinding>
                                        <Binding Path="IconObject"
                                                 IsAsync="{pmrk:Settings AsyncImageLoading, DirectValue=True}"
                                                 Mode="OneWay" Converter="{StaticResource NullToDependencyPropertyUnsetConverter}" />
                                        <Binding Path="DefaultIconObject" Mode="OneWay" />
                                    </PriorityBinding>
                                </Image.Source>
                            </Image>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Name -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Name], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Name}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameNameTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Name}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DisplayName, Mode=OneWay}" Style="{StaticResource TextItemStyle}"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Platform -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Platform], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Platform}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGamePlatformTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Platform}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Platform, Mode=OneWay}" Style="{StaticResource TextItemStyle}"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Library -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Library], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Library}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameProviderTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Library}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Library, Mode=OneWay}" Style="{StaticResource TextItemStyle}"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Developers -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Developers], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Developers}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameDevelopersTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Developers}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Developers, Mode=OneWay, Converter={StaticResource ListToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Publishers -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Publishers], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Publishers}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGamePublishersTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Publishers}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Publishers, Mode=OneWay, Converter={StaticResource ListToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- ReleaseDate -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[ReleaseDate], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.ReleaseDate}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameReleaseDateTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.ReleaseDate}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding ReleaseDate, Mode=OneWay, Converter={StaticResource NullableDateToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Genres -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Genres], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Genres}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameGenresTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Genres}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Genres, Mode=OneWay, Converter={StaticResource ListToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Categories -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Categories], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Categories}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameCategoriesTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Categories}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Categories, Mode=OneWay, Converter={StaticResource ListToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Tags -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Tags], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Tags}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameTagsTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Tags}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Tags, Mode=OneWay, Converter={StaticResource ListToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- IsInstalled -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[IsInstalled], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.IsInstalled}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameIsInstalledTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.IsInstalled}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding IsInstalled, Mode=OneWay, Converter={StaticResource BoolToYesNoConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- InstallDirectory -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[InstallDirectory], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.InstallDirectory}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameInstallDirTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.InstallDirectory}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding InstallDirectory, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- LastActivity -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[LastActivity], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.LastActivity}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCGameLastActivityTitle}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.LastActivity}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LastActivity, Mode=OneWay, Converter={StaticResource DateTimeToLastPlayedConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- Playtime -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Playtime], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Playtime}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCTimePlayed}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Playtime}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Playtime, Mode=OneWay, Converter={StaticResource LongToTimePlayedConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- PlayCount -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[PlayCount], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.PlayCount}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCPlayCountLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.PlayCount}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding PlayCount, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- CompletionStatus -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[CompletionStatus], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.CompletionStatus}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCCompletionStatus}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.CompletionStatus}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding CompletionStatus, Mode=OneWay, Converter={StaticResource CompletionStatusToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Series -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Series], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Series}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCSeriesLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Series}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Series, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Version -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Version], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Version}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCVersionLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Version}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Version, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- AgeRating -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[AgeRating], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.AgeRating}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCAgeRatingLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.AgeRating}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding AgeRating, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Region -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Region], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Region}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCRegionLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Region}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Region, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Source -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Source], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Source}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCSourceLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Source}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Source, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Added -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Added], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Added}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCAddedLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Added}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Added, Mode=OneWay, Converter={StaticResource NullableDateToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- Modified -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[Modified], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.Modified}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCModifiedLabel}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.Modified}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Modified, Mode=OneWay, Converter={StaticResource NullableDateToStringConverter}}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>

                <!-- UserScore -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[UserScore], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.UserScore}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCUserScore}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.UserScore}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding UserScore, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- CriticScore -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[CriticScore], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.CriticScore}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCCriticScore}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.CriticScore}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding CriticScore, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                
                <!-- CommunityScore -->
                <GridViewColumn Width="{Binding Path=DataContext.GridViewHeaders[CommunityScore], ElementName=HeaderMenu, Mode=TwoWay, Converter={StaticResource BoolToAutoWidthConverter}}">
                    <GridViewColumn.Header>
                        <GridViewColumnHeader Tag="{x:Static p:SortOrder.CommunityScore}">
                            <GridViewColumnHeader.Content>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource LOCCommunityScore}" />
                                    <ContentControl Style="{StaticResource SortIndicator}"
                                                    Visibility="{Binding Path=SortingOrder, Converter={StaticResource EnumCompVisibilityConverter}, ConverterParameter={x:Static p:SortOrder.CommunityScore}}"/>
                                </StackPanel>
                            </GridViewColumnHeader.Content>
                        </GridViewColumnHeader>
                    </GridViewColumn.Header>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding CommunityScore, Mode=OneWay}" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
</UserControl>
