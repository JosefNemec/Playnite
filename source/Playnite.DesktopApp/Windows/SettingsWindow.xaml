<controls:WindowBase x:Class="Playnite.DesktopApp.Windows.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:prism="clr-namespace:Prism.Interactivity;assembly=Prism.Wpf"
        xmlns:p="clr-namespace:Playnite;assembly=Playnite"
        xmlns:pcon="clr-namespace:Playnite.Converters;assembly=Playnite"
        xmlns:pcmd="clr-namespace:Playnite.Commands;assembly=Playnite"
        xmlns:pbeh="clr-namespace:Playnite.Behaviors;assembly=Playnite"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:winMedia="clr-namespace:System.Windows.Media;assembly=PresentationCore"
        xmlns:controls="clr-namespace:Playnite.Controls;assembly=Playnite"
        xmlns:pctrls="clr-namespace:Playnite.DesktopApp.Controls"
        xmlns:sysCtrls="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
        mc:Ignorable="d"
        d:DesignStyle="{StaticResource WindowDesignStyle}"
        Style="{DynamicResource StandardWindowStyle}"
        WindowStartupLocation="CenterOwner" ShowInTaskbar="False"
        Width="780" Height="620"                     
        AutomationProperties.AutomationId="WindowSettings">

    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing" >
            <prism:InvokeCommandAction Command="{Binding WindowClosingCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    
    <controls:WindowBase.Resources>
        <pcon:NegateConverter x:Key="NegateConverter" />
        <pcon:EnumToBooleanConverter x:Key="EnumConverter" />
        <sys:Double x:Key="IconSize">24</sys:Double>
        <Style TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}" />   
    </controls:WindowBase.Resources>

    <DockPanel>
        <Border DockPanel.Dock="Bottom" BorderThickness="0,1,0,0" BorderBrush="{DynamicResource NormalBorderBrush}">
            <DockPanel LastChildFill="False" Margin="5">
                <TextBlock Text="{DynamicResource LOCSettingsRestartNotification}"
                           Margin="5,0,0,0" DockPanel.Dock="Left" VerticalAlignment="Center"
                           Style="{DynamicResource BaseTextBlockStyle}" />
                <Button Name="ButtonCancel" Content="{DynamicResource LOCCancelLabel}" DockPanel.Dock="Right"
                            Style="{StaticResource BottomButton}" IsCancel="True"
                            Command="{Binding CancelCommand}"/>
                <Button Name="ButtonOK" Content="{DynamicResource LOCSaveLabel}" DockPanel.Dock="Right" 
                            Style="{StaticResource BottomButton}"
                            Command="{Binding ConfirmCommand}"/>
            </DockPanel>
        </Border>
        
        <TabControl BorderThickness="0,1,0,0" BorderBrush="{DynamicResource NormalBorderBrush}"
                    Name="TabControlMain">
            <TabItem Header="{DynamicResource LOCSettingsLabel}">
                <DockPanel>
                    <ListBox DockPanel.Dock="Left" BorderThickness="0,0,1,0" BorderBrush="{DynamicResource NormalBorderBrush}"
                          Name="TreeSections" MinWidth="140">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem" BasedOn="{StaticResource {x:Type ListBoxItem}}">
                                <Setter Property="Padding" Value="5" />
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBoxItem Content="{DynamicResource LOCSettingsGeneralLabel}" IsSelected="True">
                            <ListBoxItem.Tag>
                                <sys:Int32>0</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsAppearanceLabel}">
                            <ListBoxItem.Tag>
                                <sys:Int32>1</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsAdvancedLabel}"
                                     Margin="15,0,0,0">
                            <ListBoxItem.Tag>
                                <sys:Int32>2</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsGameDetailsLabel}"
                                     Margin="15,0,0,0">
                            <ListBoxItem.Tag>
                                <sys:Int32>3</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsLayoutLabel}"
                                     Margin="15,0,0,0">
                            <ListBoxItem.Tag>
                                <sys:Int32>4</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsAdvancedLabel}">
                            <ListBoxItem.Tag>
                                <sys:Int32>5</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsInputLabel}">
                            <ListBoxItem.Tag>
                                <sys:Int32>6</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCExtensions}">
                            <ListBoxItem.Tag>
                                <sys:Int32>7</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                        <ListBoxItem Content="{DynamicResource LOCSettingsMetadataLabel}">
                            <ListBoxItem.Tag>
                                <sys:Int32>8</sys:Int32>
                            </ListBoxItem.Tag>
                        </ListBoxItem>
                    </ListBox>
                    
                    <TabControl DockPanel.Dock="Bottom" TabStripPlacement="Top" OverridesDefaultStyle="True"
                                SelectedIndex="{Binding SelectedItem.Tag, ElementName=TreeSections}">
                        <TabControl.Style>
                            <Style TargetType="TabControl">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="TabControl">
                                            <ContentPresenter ContentSource="SelectedContent" Margin="20" />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </TabControl.Style>

                        <!-- General -->
                        <TabItem>
                            <StackPanel>
                                <StackPanel.Resources>
                                    <ObjectDataProvider MethodName="GetValues" ObjectType="{x:Type sys:Enum}"
                                                    x:Key="AfterLaunchOptionsEnumValues">
                                        <ObjectDataProvider.MethodParameters>
                                            <x:Type TypeName="p:AfterLaunchOptions" />
                                        </ObjectDataProvider.MethodParameters>
                                    </ObjectDataProvider>
                                    <pcon:AfterGameLaunchOptionToStringConverter x:Key="AfterGameLaunchOptionToStringConverter" />
                                    <ComboBox x:Key="ComboAfterGameOptions" x:Shared="False"
                                          SelectedValue="{Binding AfterLaunch}"
                                          ItemsSource="{Binding Source={StaticResource AfterLaunchOptionsEnumValues}}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource AfterGameLaunchOptionToStringConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <ObjectDataProvider MethodName="GetValues" ObjectType="{x:Type sys:Enum}"
                                                    x:Key="AfterCloseOptionsEnumValues">
                                        <ObjectDataProvider.MethodParameters>
                                            <x:Type TypeName="p:AfterGameCloseOptions" />
                                        </ObjectDataProvider.MethodParameters>
                                    </ObjectDataProvider>
                                    <pcon:AfterGameCloseOptionToStringConverter x:Key="AfterGameCloseOptionToStringConverter" />
                                    <ComboBox x:Key="ComboAfterGameCloseOptions" x:Shared="False"
                                              VerticalAlignment="Center"
                                              SelectedValue="{Binding AfterGameClose}"
                                              ItemsSource="{Binding Source={StaticResource AfterCloseOptionsEnumValues}}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource AfterGameCloseOptionToStringConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </StackPanel.Resources>
                                
                                <DockPanel Margin="0,0,0,10" LastChildFill="False">
                                    <ContentControl Content="{DynamicResource LOCLanguageSettingsLabel}" 
                                                    ContentStringFormat="{}{0} *"
                                                    VerticalAlignment="Center" Margin="5,0,10,0" />
                                    <ComboBox Name="ComboLanguage" VerticalAlignment="Center"
                                              SelectedValue="{Binding Settings.Language}"
                                              SelectedValuePath="Id" DisplayMemberPath="LocaleString"
                                              ItemsSource="{Binding AvailableLanguages}"/>
                                    <TextBlock Margin="20,0,0,0" VerticalAlignment="Center">
                                <Hyperlink Command="{x:Static pcmd:GlobalCommands.NavigateUrlCommand}"
                                           CommandParameter="https://github.com/JosefNemec/Playnite/wiki/How-to:-Translations">
                                    <Run Text="{DynamicResource LOCSettingsCreateLocalization}" />
                                </Hyperlink>
                                    </TextBlock>
                                </DockPanel>
                                
                                <StackPanel Orientation="Horizontal" Margin="5,15,5,0">
                                    <TextBlock Text="{DynamicResource LOCSettingsAfterGameStart}" Margin="0,0,5,0"
                                                VerticalAlignment="Center" />
                                    <ContentControl DataContext="{Binding Settings}"
                                            ToolTipService.InitialShowDelay="0" VerticalAlignment="Center"
                                            ToolTip="{DynamicResource LOCSettingsClosePlaytimeNotif}"
                                            Content="{StaticResource ComboAfterGameOptions}" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="5,10,5,5">
                                    <TextBlock Text="{DynamicResource LOCSettingsAfterGameClose}" Margin="0,0,5,0"
                                        VerticalAlignment="Center" />
                                    <ContentControl DataContext="{Binding Settings}"
                                                    Content="{StaticResource ComboAfterGameCloseOptions}"
                                                    VerticalAlignment="Center"/>
                                </StackPanel>

                                <CheckBox Name="CheckUpdateLibStartup" Margin="5,25,5,5"
                                    Content="{DynamicResource LOCSettingsUpdateLibStartup}" ToolTip="{DynamicResource LOCSettingsUpdateLibStartupTooltip}" 
                                    IsChecked="{Binding Settings.UpdateLibStartup}"/>

                                <CheckBox Name="CheckDownloadMetadataOnImport" Margin="5,15,5,5"
                                    Content="{DynamicResource LOCSettingsDownloadMetadataOnImport}" 
                                    IsChecked="{Binding Settings.DownloadMetadataOnImport}"/>

                                <CheckBox Name="CheckStartFullscreen" Margin="5,15,5,5"
                                    Content="{DynamicResource LOCSettingsStartInFullscreen}"
                                    IsChecked="{Binding Settings.StartInFullscreen}"/>

                                <CheckBox Name="CheckStartOnBoot" Margin="5,15,5,5"
                                    Content="{DynamicResource LOCSettingsStartOnBoot}"
                                    IsChecked="{Binding Settings.StartOnBoot}"/>

                                <CheckBox Name="CheckStartMinimized" Margin="5,15,5,5"
                                    Content="{DynamicResource LOCSettingsStartMinimized}"
                                    IsChecked="{Binding Settings.StartMinimized}"/>

                                <CheckBox Name="CheckAlwaysSyncTime" Margin="5,15,5,5"
                                    Content="{DynamicResource LOCSettingsForceDownloadPlaynite}"
                                    ToolTip="{DynamicResource LOCSettingsForceDownloadPlayniteTooltip}" ToolTipService.InitialShowDelay="0"
                                    IsChecked="{Binding Settings.ForcePlayTimeSync}"/>                                    
                            </StackPanel>
                        </TabItem>
                        
                        <!-- Appearance -->                        
                        <TabItem>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <ContentControl VerticalAlignment="Center"
                                                    Content="{DynamicResource LOCSettingsSkin}"                                                    
                                                    ContentStringFormat="{}{0} *"/>
                                    <ComboBox Margin="10,0,0,0"
                                              ItemsSource="{Binding AvailableThemes}"
                                              SelectedValue="{Binding Settings.Theme}"
                                              SelectedValuePath="DirectoryName"
                                              DisplayMemberPath="Name" />
                                    <!--TODO update links -->
                                    <TextBlock Margin="20,0,0,0" VerticalAlignment="Center">
                                        <Hyperlink Command="{x:Static pcmd:GlobalCommands.NavigateUrlCommand}"
                                                   CommandParameter="https://github.com/JosefNemec/Playnite/wiki/How-to:-Themes">
                                            <Run Text="{DynamicResource LOCSettingsGetThemes}" />
                                        </Hyperlink>
                                    </TextBlock>
                                    <TextBlock Margin="20,0,0,0" VerticalAlignment="Center">
                                        <Hyperlink Command="{x:Static pcmd:GlobalCommands.NavigateUrlCommand}"
                                                   CommandParameter="https://github.com/JosefNemec/Playnite/wiki/How-to:-Themes">
                                            <Run Text="{DynamicResource LOCSettingsCreateThemes}" />
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="0,15,0,0" >
                                    <CheckBox Name="CheckEnableTray" VerticalAlignment="Center"
                                                  IsChecked="{Binding Settings.EnableTray}"
                                                  Content="{DynamicResource LOCSettingsShowTray}"
                                                  ContentStringFormat="{}{0} *" />
                                    <ComboBox Margin="5,0,0,0" VerticalAlignment="Center"
                                                  ItemsSource="{Binding AvailableTrayIcons}"
                                                  SelectedValue="{Binding Settings.TrayIcon}"
                                                  SelectedValuePath="TrayIcon"
                                                  IsEnabled="{Binding Settings.EnableTray}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <Image RenderOptions.BitmapScalingMode="Fant"
                                                           VerticalAlignment="Center" Height="16" Margin="5"
                                                           Source="{Binding ImageSource}" />
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </StackPanel>
                                <CheckBox Name="CheckMinimizeToTray" Content="{DynamicResource LOCSettingsMinimizeToTray}" Margin="20,10,5,5"
                                        IsChecked="{Binding Settings.MinimizeToTray}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckEnableTray}" />
                                <CheckBox Name="CheckCloseToTray" Content="{DynamicResource LOCSettingsCloseToTray}" Margin="20,5,5,5"
                                        IsChecked="{Binding Settings.CloseToTray}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckEnableTray}" />

                                <CheckBox Content="{DynamicResource LOCSettingsShowNameEmptyCover}" Margin="0,15,0,0"
                                          Name="CheckNameEmptyCover" IsChecked="{Binding Settings.ShowNameEmptyCover}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsShowNamesUnderCover}" Margin="0,15,0,0"
                                          Name="CheckNameUnderCover" IsChecked="{Binding Settings.ShowNamesUnderCovers}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsShowIconList}" Margin="0,15,0,0"
                                          Name="CheckShowIcons" IsChecked="{Binding Settings.ShowIconsOnList}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsShowGroupCount}" Margin="0,15,0,0"
                                          Name="CheckShowGroupCount" IsChecked="{Binding Settings.ShowGroupCount}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsShowSteamFriendsButton}" Margin="0,15,0,0"
                                          Name="CheckShowSteamFriends" IsChecked="{Binding Settings.ShowSteamFriendsButton}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsShowBackgroundImage}" Margin="0,15,0,0"
                                          Name="CheckShowBackgroundImage" IsChecked="{Binding Settings.ShowBackgroundImage}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsShowBackgroundImageOnWindow}" Margin="25,15,0,0"
                                          Name="CheckShowBackgroundImageOnWindow" IsChecked="{Binding Settings.StrechBackgroundImage}"
                                          IsEnabled="{Binding Settings.ShowBackgroundImage}"/>                                
                            </StackPanel>
                        </TabItem>

                        <!-- Appearance Advanced -->
                        <TabItem>
                            <StackPanel>
                                <Grid pbeh:GridBehaviors.ColumnCount="2"
                                      pbeh:GridBehaviors.RowCount="12">                                    
                                    <ContentControl Content="{DynamicResource LOCSettingsDefaulIconSource}"
                                                    ContentStringFormat="{}{0} *"
                                                    Grid.Column="0" Grid.Row="0"
                                                    Margin="0,10,10,10" VerticalAlignment="Center" />
                                    <ComboBox SelectedValue="{Binding Settings.DefaultIconSource}"
                                              VerticalAlignment="Center"
                                              Grid.Column="1" Grid.Row="0">
                                        <ComboBox.ItemsSource>
                                            <x:Array Type="{x:Type sys:Enum}">
                                                <p:DefaultIconSourceOptions>Library</p:DefaultIconSourceOptions>
                                                <p:DefaultIconSourceOptions>Platform</p:DefaultIconSourceOptions>
                                                <p:DefaultIconSourceOptions>General</p:DefaultIconSourceOptions>
                                            </x:Array>
                                        </ComboBox.ItemsSource>
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={pcon:ObjectToStringConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>

                                    <ContentControl Content="{DynamicResource LOCSettingsDefaulCoverSource}"
                                                    ContentStringFormat="{}{0} *"
                                                    Grid.Column="0" Grid.Row="1"
                                                    Margin="0,10,10,10" VerticalAlignment="Center" />
                                    <ComboBox SelectedValue="{Binding Settings.DefaultCoverSource}"
                                              VerticalAlignment="Center"
                                              Grid.Column="1" Grid.Row="1">
                                        <ComboBox.ItemsSource>
                                            <x:Array Type="{x:Type sys:Enum}">
                                                <p:DefaultCoverSourceOptions>Platform</p:DefaultCoverSourceOptions>
                                                <p:DefaultCoverSourceOptions>General</p:DefaultCoverSourceOptions>
                                            </x:Array>
                                        </ComboBox.ItemsSource>
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={pcon:ObjectToStringConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </Grid>                                
                            </StackPanel>
                        </TabItem>

                        <!-- Game Details -->
                        <TabItem>
                            <StackPanel>
                                <TextBlock Text="{DynamicResource LOCSettingsDetailsPanelItems}" />
                                <UniformGrid Columns="3" VerticalAlignment="Top">
                                    <CheckBox Content="{DynamicResource LOCGameIconTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Icon}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCGameCoverTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.CoverImage}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCTimePlayed}"
                                              IsChecked="{Binding Settings.DetailsVisibility.PlayTime}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCGameLastActivityTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.LastPlayed}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCCompletionStatus}"
                                              IsChecked="{Binding Settings.DetailsVisibility.CompletionStatus}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCPlatformTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Platform}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCGameProviderTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Library}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCGameGenresTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Genres}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCDeveloperLabel}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Developers}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCPublisherLabel}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Publishers}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCGameReleaseDateTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.ReleaseDate}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCCategoryLabel}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Categories}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCTagLabel}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Tags}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCLinksLabel}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Links}"
                                              Margin="0,10,0,0"/>
                                    <CheckBox Content="{DynamicResource LOCGameDescriptionTitle}"
                                              IsChecked="{Binding Settings.DetailsVisibility.Description}"
                                              Margin="0,10,0,0"/>
                                </UniformGrid>
                            </StackPanel>
                        </TabItem>

                        <!-- Layout -->
                        <TabItem>
                            <TabItem.Resources>
                                <x:Array x:Key="LeftRightDockOptions" Type="{x:Type sys:Enum}">
                                    <sysCtrls:Dock>Left</sysCtrls:Dock>
                                    <sysCtrls:Dock>Right</sysCtrls:Dock>
                                </x:Array>
                                <DataTemplate x:Key="LeftRightComboTemplate">
                                    <TextBlock Text="{Binding Converter={pcon:DockToStringConverter}}"/>
                                </DataTemplate>
                            </TabItem.Resources>
                            <StackPanel>
                                <StackPanel.Resources>
                                    <ObjectDataProvider MethodName="GetValues" ObjectType="{x:Type sys:Enum}"
                                                        x:Key="CoverArtStretchValues">
                                        <ObjectDataProvider.MethodParameters>
                                            <x:Type TypeName="winMedia:Stretch" />
                                        </ObjectDataProvider.MethodParameters>
                                    </ObjectDataProvider>
                                    <ComboBox x:Key="ComboStrechOptions" x:Shared="False"
                                          SelectedValue="{Binding CoverArtStretch}"
                                          ItemsSource="{Binding Source={StaticResource CoverArtStretchValues}}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={pcon:StrechToStringConverter}}"/>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                </StackPanel.Resources>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="{DynamicResource LOCSettingsFilterPanelPosition}"
                                            VerticalAlignment="Center"
                                           Grid.Column="0" Grid.Row="0" />
                                    <ComboBox ItemTemplate="{StaticResource LeftRightComboTemplate}"
                                            ItemsSource="{StaticResource LeftRightDockOptions}"
                                            SelectedValue="{Binding Settings.FilterPanelPosition}"
                                            Margin="5" Grid.Column="1" Grid.Row="0" />

                                    <TextBlock Text="{DynamicResource LOCSettingsExplorerPanelPosition}"
                                            VerticalAlignment="Center"
                                           Grid.Column="0" Grid.Row="1"  />
                                    <ComboBox ItemTemplate="{StaticResource LeftRightComboTemplate}"
                                            ItemsSource="{StaticResource LeftRightDockOptions}"
                                            SelectedValue="{Binding Settings.ExplorerPanelPosition}"
                                            Margin="5" Grid.Column="1" Grid.Row="1" />

                                    <TextBlock Text="{DynamicResource LOCSettingsGridViewDetailsPosition}"
                                            VerticalAlignment="Center"
                                           Grid.Column="0" Grid.Row="2"  />
                                    <ComboBox ItemTemplate="{StaticResource LeftRightComboTemplate}"
                                            ItemsSource="{StaticResource LeftRightDockOptions}"
                                            SelectedValue="{Binding Settings.GridViewDetailsPosition}"
                                            Margin="5" Grid.Column="1" Grid.Row="2" />
                                </Grid>

                                <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                                    <CheckBox IsChecked="{Binding Settings.IndentGameDetails}" VerticalAlignment="Center"
                                              Content="{DynamicResource LOCSettingsIndentGameDetails}" />
                                    <pctrls:NullableIntBox MinValue="0" MaxValue="2048" Width="60" Margin="10,0,0,0"
                                                           Value="{Binding Settings.GameDetailsIndentation}"
                                                           IsEnabled="{Binding Settings.IndentGameDetails}" />

                                </StackPanel>

                                <TextBlock Text="{DynamicResource LOCSettingsCoverArtRenderingLabel}" Margin="0,30,0,0" />
                                <Separator />


                                <Grid pbeh:GridBehaviors.ColumnCount="2"
                                      pbeh:GridBehaviors.RowCount="4"
                                      Margin="0,10,0,0">
                                    <TextBlock Text="{DynamicResource LOCSettingsTargetAspectRatioLabel}"
                                               VerticalAlignment="Center" Margin="0,10,0,10"
                                               Grid.Column="0" Grid.Row="0"/>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center"
                                                Grid.Column="1" Grid.Row="0">
                                        <pctrls:NullableIntBox MinValue="1" MaxValue="100" Width="30"
                                                           Margin="10,0,0,0"
                                                           Value="{Binding Settings.GridItemWidthRatio}"/>
                                        <TextBlock Text=":" VerticalAlignment="Center"
                                               Margin="2,0,2,0"/>
                                        <pctrls:NullableIntBox MinValue="1" MaxValue="100" Width="30"
                                                           Value="{Binding Settings.GridItemHeightRatio}"/>

                                        <Button Content="{DynamicResource LOCPresets}" Margin="15,0,0,0" Padding="2"
                                            pbeh:LeftClickContextMenuBehavior.Enabled="True">
                                            <Button.ContextMenu>
                                                <ContextMenu Placement="Bottom">
                                                    <MenuItem Header="{DynamicResource LOCSettingsCovertAspectDVD}"
                                                          Command="{Binding SetCoverArtAspectRatioCommand}"
                                                          CommandParameter="27:38"/>
                                                    <MenuItem Header="{DynamicResource LOCSettingsCovertAspectSteam}"
                                                          Command="{Binding SetCoverArtAspectRatioCommand}"
                                                          CommandParameter="92:43"/>
                                                </ContextMenu>
                                            </Button.ContextMenu>
                                        </Button>
                                    </StackPanel>
                                    
                                    <TextBlock Text="{DynamicResource LOCSettingsStrechModeLabel}"
                                               VerticalAlignment="Center" Margin="0,10,0,10"
                                               Grid.Column="0" Grid.Row="1"/>
                                    <ContentControl DataContext="{Binding Settings}"
                                                    Grid.Column="1" Grid.Row="1"
                                                    Content="{StaticResource ComboStrechOptions}"
                                                    MinWidth="140" Margin="10,0,0,0"
                                                    VerticalAlignment="Center" HorizontalAlignment="Left"/>
                              
                                    <TextBlock Text="{DynamicResource LOCSettingsGridItemSpacing}"
                                               VerticalAlignment="Center" Margin="0,10,0,10"
                                               Grid.Column="0" Grid.Row="2"/>
                                    <pctrls:NullableIntBox MinValue="0" MaxValue="100" Margin="10,0,0,0" Width="40"
                                                           HorizontalAlignment="Left" VerticalAlignment="Center"
                                                           Value="{Binding Settings.GridItemSpacing}"
                                                           Grid.Column="1" Grid.Row="2"/>
                          
                                    <TextBlock Text="{DynamicResource LOCSettingsGridItemCoverMargin}"
                                               VerticalAlignment="Center" Margin="0,10,0,10"
                                                Grid.Column="0" Grid.Row="3"/>
                                    <pctrls:NullableIntBox MinValue="0" MaxValue="100" Margin="10,0,0,0" Width="40"
                                                           HorizontalAlignment="Left" VerticalAlignment="Center"
                                                           Value="{Binding Settings.GridItemMargin}"
                                                           Grid.Column="1" Grid.Row="3"/>
                                </Grid>
                            </StackPanel>
                        </TabItem>

                        <!-- Advanced -->
                        <TabItem>
                            <StackPanel>
                                <DockPanel>
                                    <ContentControl Content="{DynamicResource LOCSettingsDBLocation}"
                                                    ContentStringFormat="{}{0} *" 
                                                    DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                    <Button Name="ButtonBrowserDbFile" Content="{DynamicResource LOCChange}"
                                            DockPanel.Dock="Right" Padding="5,0,5,0"
                                            Command="{Binding SelectDbFileCommand}"/>
                                    <TextBox Name="TextDatabase" Text="{Binding Settings.DatabasePath}"
                                             DockPanel.Dock="Left" Margin="10,0,10,0"
                                             IsReadOnly="True"/>
                                </DockPanel>
                                <CheckBox Content="{DynamicResource LOCSettingsDisableAcceleration}"
                                          ContentStringFormat="{}{0} *"
                                          ToolTip="{DynamicResource LOCSettingsDisableAccelerationTooltip}"
                                          Name="CheckDisableAcceleration" IsChecked="{Binding Settings.DisableHwAcceleration}"
                                          Margin="0,45,0,0"/>
                                <CheckBox Content="{DynamicResource LOCSettingsDisableDpiAwareness}"
                                          ContentStringFormat="{}{0} *"
                                          Name="CheckDisableDpiAwareness" IsChecked="{Binding Settings.DisableDpiAwareness}"
                                          Margin="0,15,0,0"/>
                                <CheckBox Content="{DynamicResource LOCSettingsAsyncImageLoading}"
                                          ContentStringFormat="{}{0} *"
                                          ToolTip="{DynamicResource LOCSettingsAsyncImageLoadingTooltip}"
                                          Margin="0,15,0,0"
                                          Name="CheckAsyncImages" IsChecked="{Binding Settings.AsyncImageLoading}"/>
                                <Button Name="ButtonClearWebCace" Content="{DynamicResource LOCSettingsClearWebCache}"
                                        HorizontalAlignment="Left" Margin="0,45,0,0"
                                        ToolTip="{DynamicResource LOCSettingsClearWebCacheTooltip}" ToolTipService.InitialShowDelay="0"
                                        Command="{Binding ClearWebCacheCommand}"/>
                            </StackPanel>
                        </TabItem>

                        <!-- Input -->
                        <TabItem>
                            <StackPanel>
                                <CheckBox Content="{DynamicResource LOCSettingsXInputInDesktopMode}"
                                          ContentStringFormat="{}{0} *"
                                          Name="CheckXInputEnabled"
                                          IsChecked="{Binding Settings.EnableControllerInDesktop}"/>
                                <CheckBox Content="{DynamicResource LOCSettingsXInputGuideOpensFullscreen}"
                                          Margin="15,15,0,0" 
                                          IsChecked="{Binding Settings.GuideButtonOpensFullscreen}"
                                          IsEnabled="{Binding IsChecked, ElementName=CheckXInputEnabled}"/>
                            </StackPanel>
                            
                        </TabItem>

                        <!-- Extensions -->
                        <TabItem>
                            <Grid Margin="-15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="250" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Column="1" DataContext="{Binding SelectedItem, ElementName=ListExtensions}"
                                            Margin="10,5,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock FontWeight="Bold" Text="{DynamicResource LOCExtensionCreatedBy}" />
                                        <TextBlock Text="{Binding Description.Author}" Margin="5,0,0,0" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                        <TextBlock FontWeight="Bold" Text="{DynamicResource LOCExtensionVersion}" />
                                        <TextBlock Text="{Binding Description.Version}" Margin="5,0,0,0" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                        <TextBlock FontWeight="Bold" Text="{DynamicResource LOCExtensionModule}" />
                                        <TextBlock Text="{Binding Description.Module}" Margin="5,0,0,0" />
                                    </StackPanel>
                                    <CheckBox Content="{DynamicResource LOCEnabledTitle}" Margin="0,15,0,0"
                                              IsChecked="{Binding Selected}" />
                                </StackPanel>

                                <ListBox Grid.Column="0" Name="ListExtensions" SelectedIndex="0"
                                         ItemsSource="{Binding PluginsList}">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem" BasedOn="{StaticResource {x:Type ListBoxItem}}">
                                            <Setter Property="Opacity" Value="1" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Selected}" Value="False">
                                                    <Setter Property="Opacity" Value="0.5" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image RenderOptions.BitmapScalingMode="Fant"
                                                       VerticalAlignment="Center" Height="24" Margin="5"
                                                       Source="{Binding PluginIcon}" />
                                                <TextBlock FontSize="14" VerticalAlignment="Center"
                                                           Margin="0,5,5,5"
                                                           Text="{Binding Description.Name}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                            </Grid>                            
                        </TabItem>  
                        
                        <!-- Metadata -->
                        <TabItem>
                            <DockPanel>
                                <TextBlock Text="{DynamicResource LOCSettingsDefaultMetadataDescription}"
                                    DockPanel.Dock="Top" TextWrapping="Wrap" />
                                <pctrls:MetadataDownloadSettings Settings="{Binding Settings.DefaultMetadataSettings}" />
                            </DockPanel>
                        </TabItem>
                    </TabControl>
                </DockPanel>
            </TabItem>

            <TabItem Header="{DynamicResource LOCLibraries}">
                <DockPanel>
                    <ListBox Name="TreeLibraryPlugins" MinWidth="140"                              
                             BorderThickness="0,0,1,0" BorderBrush="{DynamicResource NormalBorderBrush}">       
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Value.Name}" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem" BasedOn="{StaticResource {x:Type ListBoxItem}}">
                                <Setter Property="Padding" Value="5" />
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.Style>
                            <Style TargetType="ListBox" BasedOn="{StaticResource {x:Type ListBox}}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedIndex, ElementName=TabControlMain}" Value="1">
                                        <Setter Property="ItemsSource" Value="{Binding LibraryPluginSettings}" />
                                        <Setter Property="SelectedIndex" Value="0" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.Style>
                    </ListBox>
                    <ScrollViewer DockPanel.Dock="Left">
                        <ContentControl Content="{Binding SelectedItem.Value.View, ElementName=TreeLibraryPlugins}"
                                        Margin="20"/>
                    </ScrollViewer>
                </DockPanel>
            </TabItem>

            <TabItem Header="{DynamicResource LOCPlugins}"
                     Visibility="{Binding AnyGenericPluginSettings, Converter={pcon:BooleanToVisibilityConverter}}">
                <DockPanel>
                    <ListBox Name="TreeGenericPlugins" MinWidth="140"
                             BorderThickness="0,0,1,0" BorderBrush="{DynamicResource NormalBorderBrush}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Value.Name}" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem" BasedOn="{StaticResource {x:Type ListBoxItem}}">
                                <Setter Property="Padding" Value="5" />
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.Style>
                            <Style TargetType="ListBox" BasedOn="{StaticResource {x:Type ListBox}}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedIndex, ElementName=TabControlMain}" Value="2">
                                        <Setter Property="ItemsSource" Value="{Binding GenericPluginSettings}" />
                                        <Setter Property="SelectedIndex" Value="0" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.Style>
                    </ListBox>
                    <ContentControl DockPanel.Dock="Left" Margin="20"
                                    Content="{Binding SelectedItem.Value.View, ElementName=TreeGenericPlugins}"/>
                </DockPanel>
            </TabItem>
        </TabControl>
    </DockPanel>
</controls:WindowBase>
